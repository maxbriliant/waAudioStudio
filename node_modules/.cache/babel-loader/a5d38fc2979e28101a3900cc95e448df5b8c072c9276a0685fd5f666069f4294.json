{"ast":null,"code":"var _jsxFileName = \"/home/maksim/src/react/wa-audio-sandbox-20/src/components/WhatsAppAudioRecorder.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect, useCallback } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function WhatsAppAudioRecorder() {\n  _s();\n  var _mediaRecorderRef$cur;\n  const [recordings, setRecordings] = useState([]);\n  const [isRecording, setIsRecording] = useState(false);\n  const [recordingTime, setRecordingTime] = useState(0);\n  const [audioStream, setAudioStream] = useState(null);\n  const [permissionStatus, setPermissionStatus] = useState('prompt'); // 'granted', 'denied', 'prompt'\n  const [error, setError] = useState(null);\n  const mediaRecorderRef = useRef(null);\n  const audioChunksRef = useRef([]);\n  const timerRef = useRef(null);\n  const audioContextRef = useRef(null);\n  const analyserRef = useRef(null);\n  const dataArrayRef = useRef(null);\n  const animationRef = useRef(null);\n  const canvasRef = useRef(null);\n\n  // Check microphone permissions on component mount\n  useEffect(() => {\n    checkPermissions();\n  }, []);\n  const checkPermissions = async () => {\n    try {\n      const result = await navigator.permissions.query({\n        name: 'microphone'\n      });\n      setPermissionStatus(result.state);\n      result.addEventListener('change', () => {\n        setPermissionStatus(result.state);\n        if (result.state === 'denied' && isRecording) {\n          stopRecording();\n        }\n      });\n    } catch (err) {\n      console.warn('Permission API not supported, fallback to getUserMedia');\n    }\n  };\n\n  // Cleanup function to properly stop all recording activities\n  const cleanup = useCallback(() => {\n    // Stop timer\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n      timerRef.current = null;\n    }\n\n    // Stop animation\n    if (animationRef.current) {\n      cancelAnimationFrame(animationRef.current);\n      animationRef.current = null;\n    }\n\n    // Close audio context\n    if (audioContextRef.current && audioContextRef.current.state !== 'closed') {\n      audioContextRef.current.close();\n      audioContextRef.current = null;\n    }\n\n    // Stop media recorder\n    if (mediaRecorderRef.current && mediaRecorderRef.current.state !== 'inactive') {\n      try {\n        mediaRecorderRef.current.stop();\n      } catch (e) {\n        console.warn('MediaRecorder was already stopped');\n      }\n      mediaRecorderRef.current = null;\n    }\n\n    // Stop audio stream\n    if (audioStream) {\n      audioStream.getTracks().forEach(track => {\n        track.stop();\n      });\n      setAudioStream(null);\n    }\n\n    // Reset states\n    setIsRecording(false);\n    setRecordingTime(0);\n    setError(null);\n  }, [audioStream]);\n\n  // Main cleanup useEffect\n  useEffect(() => {\n    return cleanup;\n  }, [cleanup]);\n\n  // Timer effect\n  useEffect(() => {\n    if (isRecording) {\n      timerRef.current = setInterval(() => {\n        setRecordingTime(prev => prev + 1);\n      }, 1000);\n    } else {\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n        timerRef.current = null;\n      }\n      setRecordingTime(0);\n    }\n    return () => {\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n      }\n    };\n  }, [isRecording]);\n  const drawWaveform = useCallback(() => {\n    if (!canvasRef.current || !analyserRef.current) return;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n    const analyser = analyserRef.current;\n    const dataArray = dataArrayRef.current;\n    const draw = () => {\n      if (!isRecording) return; // Stop drawing if not recording\n\n      animationRef.current = requestAnimationFrame(draw);\n      analyser.getByteTimeDomainData(dataArray);\n      ctx.fillStyle = \"#fff\";\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n      ctx.lineWidth = 2;\n      ctx.strokeStyle = \"#25D366\";\n      ctx.beginPath();\n      const sliceWidth = canvas.width * 1.0 / dataArray.length;\n      let x = 0;\n      for (let i = 0; i < dataArray.length; i++) {\n        const v = dataArray[i] / 128.0;\n        const y = v * canvas.height / 2;\n        if (i === 0) {\n          ctx.moveTo(x, y);\n        } else {\n          ctx.lineTo(x, y);\n        }\n        x += sliceWidth;\n      }\n      ctx.lineTo(canvas.width, canvas.height / 2);\n      ctx.stroke();\n    };\n    draw();\n  }, [isRecording]);\n  const startRecording = async () => {\n    try {\n      setError(null);\n\n      // First, clean up any existing recording\n      cleanup();\n\n      // Check permissions first\n      await checkPermissions();\n      if (permissionStatus === 'denied') {\n        setError('Microphone access denied. Please enable microphone permissions.');\n        return;\n      }\n\n      // Get new stream\n      const stream = await navigator.mediaDevices.getUserMedia({\n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          sampleRate: 44100\n        }\n      });\n      setAudioStream(stream);\n\n      // Set up audio context for visualization\n      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n      const source = audioCtx.createMediaStreamSource(stream);\n      const analyser = audioCtx.createAnalyser();\n      source.connect(analyser);\n      analyser.fftSize = 2048;\n      const bufferLength = analyser.frequencyBinCount;\n      const dataArray = new Uint8Array(bufferLength);\n      audioContextRef.current = audioCtx;\n      analyserRef.current = analyser;\n      dataArrayRef.current = dataArray;\n\n      // Set up media recorder\n      const mediaRecorder = new MediaRecorder(stream, {\n        mimeType: MediaRecorder.isTypeSupported(\"audio/webm\") ? \"audio/webm\" : \"audio/ogg\",\n        audioBitsPerSecond: 128000\n      });\n      mediaRecorderRef.current = mediaRecorder;\n      audioChunksRef.current = [];\n      mediaRecorder.ondataavailable = event => {\n        if (event.data.size > 0) {\n          audioChunksRef.current.push(event.data);\n        }\n      };\n      mediaRecorder.onstop = () => {\n        const mimeType = mediaRecorder.mimeType || 'audio/webm';\n        const blob = new Blob(audioChunksRef.current, {\n          type: mimeType\n        });\n        const url = URL.createObjectURL(blob);\n        setRecordings(prev => [...prev, {\n          url,\n          blob,\n          duration: recordingTime,\n          timestamp: new Date().toLocaleTimeString()\n        }]);\n        audioChunksRef.current = [];\n      };\n      mediaRecorder.onerror = event => {\n        console.error('MediaRecorder error:', event);\n        setError('Recording failed: ' + event.error);\n        cleanup();\n      };\n\n      // Start recording\n      mediaRecorder.start(100); // Collect data every 100ms\n      setIsRecording(true);\n\n      // Start waveform drawing\n      drawWaveform();\n    } catch (err) {\n      console.error(\"Recording error:\", err);\n      setError(`Recording failed: ${err.message}`);\n      cleanup();\n    }\n  };\n  const stopRecording = () => {\n    if (mediaRecorderRef.current && mediaRecorderRef.current.state === 'recording') {\n      mediaRecorderRef.current.stop();\n    }\n    cleanup();\n  };\n  const copyToClipboard = async blob => {\n    try {\n      if (!navigator.clipboard.write) {\n        throw new Error('Clipboard API not supported');\n      }\n      const file = new File([blob], \"voice.webm\", {\n        type: blob.type\n      });\n      const item = new ClipboardItem({\n        [file.type]: file\n      });\n      await navigator.clipboard.write([item]);\n      alert(\"Audio copied to clipboard!\");\n    } catch (err) {\n      console.error(\"Clipboard write failed:\", err);\n      alert(\"Copy failed: \" + err.message);\n    }\n  };\n  const saveRecording = blob => {\n    const a = document.createElement(\"a\");\n    a.href = URL.createObjectURL(blob);\n    a.download = `recording_${Date.now()}.webm`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(a.href);\n  };\n  const removeRecording = index => {\n    setRecordings(prev => {\n      const newRecordings = prev.filter((_, i) => i !== index);\n      // Clean up object URL to prevent memory leaks\n      URL.revokeObjectURL(prev[index].url);\n      return newRecordings;\n    });\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-[#ece5dd] min-h-screen p-4 space-y-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-sm text-gray-600 mb-2\",\n      children: [\"Microphone: \", permissionStatus === 'granted' ? '✅ Granted' : permissionStatus === 'denied' ? '❌ Denied' : '⏳ Pending']\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4\",\n      children: [error, /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setError(null),\n        className: \"float-right text-red-500 hover:text-red-700\",\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 293,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center space-x-2\",\n      children: !isRecording ? /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startRecording,\n        disabled: permissionStatus === 'denied',\n        className: `px-4 py-2 rounded-full shadow-md transition-colors ${permissionStatus === 'denied' ? 'bg-gray-300 text-gray-500 cursor-not-allowed' : 'bg-white border border-gray-300 hover:bg-gray-100 text-black'}`,\n        title: permissionStatus === 'denied' ? 'Microphone access denied' : 'Start recording',\n        children: \"\\uD83C\\uDF99\\uFE0F Start Recording\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 307,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: stopRecording,\n        className: \"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-full shadow-md relative transition-colors\",\n        title: \"Stop recording\",\n        children: [\"\\u23F9\\uFE0F Stop (\", recordingTime, \"s)\", /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"absolute -top-1 -right-1 w-3 h-3 bg-red-400 rounded-full animate-ping\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 326,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 320,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 305,\n      columnNumber: 7\n    }, this), isRecording && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white p-3 rounded-lg shadow\",\n      children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        width: 400,\n        height: 80,\n        className: \"w-full border rounded\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 334,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center text-sm text-gray-500 mt-2\",\n        children: [\"Recording... \", recordingTime, \"s\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 340,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 333,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-3\",\n      children: recordings.length === 0 ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center text-gray-500 py-8\",\n        children: \"No recordings yet. Click \\\"Start Recording\\\" to begin.\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 349,\n        columnNumber: 11\n      }, this) : recordings.map((rec, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex items-center space-x-3 bg-[#dcf8c6] p-3 rounded-xl shadow-md w-fit max-w-full\",\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"https://www.gravatar.com/avatar?d=mp\",\n          alt: \"Avatar\",\n          className: \"w-10 h-10 rounded-full flex-shrink-0\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 358,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex flex-col min-w-0 flex-1\",\n          children: [/*#__PURE__*/_jsxDEV(\"audio\", {\n            controls: true,\n            src: rec.url,\n            className: \"w-60 min-w-0\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 364,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-500 flex justify-between\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: [rec.duration, \"s\"]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 366,\n              columnNumber: 19\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: rec.timestamp\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 367,\n              columnNumber: 19\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 365,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 363,\n          columnNumber: 15\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex space-x-1 flex-shrink-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => copyToClipboard(rec.blob),\n            className: \"text-green-700 hover:text-green-900 p-1 rounded transition-colors\",\n            title: \"Copy to clipboard\",\n            children: \"\\uD83D\\uDCCB\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 371,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => saveRecording(rec.blob),\n            className: \"text-blue-700 hover:text-blue-900 p-1 rounded transition-colors\",\n            title: \"Download recording\",\n            children: \"\\uD83D\\uDCBE\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 378,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => removeRecording(index),\n            className: \"text-red-700 hover:text-red-900 p-1 rounded transition-colors\",\n            title: \"Delete recording\",\n            children: \"\\uD83D\\uDDD1\\uFE0F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 385,\n            columnNumber: 17\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 370,\n          columnNumber: 15\n        }, this)]\n      }, index, true, {\n        fileName: _jsxFileName,\n        lineNumber: 354,\n        columnNumber: 13\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 347,\n      columnNumber: 7\n    }, this), process.env.NODE_ENV === 'development' && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-8 p-4 bg-gray-100 rounded text-xs\",\n      children: [/*#__PURE__*/_jsxDEV(\"h4\", {\n        className: \"font-bold mb-2\",\n        children: \"Debug Info:\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 401,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Recording: \", isRecording ? 'Yes' : 'No']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 402,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Stream: \", audioStream ? 'Active' : 'None']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 403,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"MediaRecorder: \", ((_mediaRecorderRef$cur = mediaRecorderRef.current) === null || _mediaRecorderRef$cur === void 0 ? void 0 : _mediaRecorderRef$cur.state) || 'None']\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        children: [\"Permission: \", permissionStatus]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 405,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 400,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 284,\n    columnNumber: 5\n  }, this);\n}\n_s(WhatsAppAudioRecorder, \"YR0krhsY3qXL/g6T5OB7SJSm3iM=\");\n_c = WhatsAppAudioRecorder;\nvar _c;\n$RefreshReg$(_c, \"WhatsAppAudioRecorder\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","jsxDEV","_jsxDEV","WhatsAppAudioRecorder","_s","_mediaRecorderRef$cur","recordings","setRecordings","isRecording","setIsRecording","recordingTime","setRecordingTime","audioStream","setAudioStream","permissionStatus","setPermissionStatus","error","setError","mediaRecorderRef","audioChunksRef","timerRef","audioContextRef","analyserRef","dataArrayRef","animationRef","canvasRef","checkPermissions","result","navigator","permissions","query","name","state","addEventListener","stopRecording","err","console","warn","cleanup","current","clearInterval","cancelAnimationFrame","close","stop","e","getTracks","forEach","track","setInterval","prev","drawWaveform","canvas","ctx","getContext","analyser","dataArray","draw","requestAnimationFrame","getByteTimeDomainData","fillStyle","fillRect","width","height","lineWidth","strokeStyle","beginPath","sliceWidth","length","x","i","v","y","moveTo","lineTo","stroke","startRecording","stream","mediaDevices","getUserMedia","audio","echoCancellation","noiseSuppression","sampleRate","audioCtx","window","AudioContext","webkitAudioContext","source","createMediaStreamSource","createAnalyser","connect","fftSize","bufferLength","frequencyBinCount","Uint8Array","mediaRecorder","MediaRecorder","mimeType","isTypeSupported","audioBitsPerSecond","ondataavailable","event","data","size","push","onstop","blob","Blob","type","url","URL","createObjectURL","duration","timestamp","Date","toLocaleTimeString","onerror","start","message","copyToClipboard","clipboard","write","Error","file","File","item","ClipboardItem","alert","saveRecording","a","document","createElement","href","download","now","body","appendChild","click","removeChild","revokeObjectURL","removeRecording","index","newRecordings","filter","_","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","title","ref","map","rec","src","alt","controls","process","env","NODE_ENV","_c","$RefreshReg$"],"sources":["/home/maksim/src/react/wa-audio-sandbox-20/src/components/WhatsAppAudioRecorder.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from \"react\";\n\nexport default function WhatsAppAudioRecorder() {\n  const [recordings, setRecordings] = useState([]);\n  const [isRecording, setIsRecording] = useState(false);\n  const [recordingTime, setRecordingTime] = useState(0);\n  const [audioStream, setAudioStream] = useState(null);\n  const [permissionStatus, setPermissionStatus] = useState('prompt'); // 'granted', 'denied', 'prompt'\n  const [error, setError] = useState(null);\n  \n  const mediaRecorderRef = useRef(null);\n  const audioChunksRef = useRef([]);\n  const timerRef = useRef(null);\n  const audioContextRef = useRef(null);\n  const analyserRef = useRef(null);\n  const dataArrayRef = useRef(null);\n  const animationRef = useRef(null);\n  const canvasRef = useRef(null);\n\n  // Check microphone permissions on component mount\n  useEffect(() => {\n    checkPermissions();\n  }, []);\n\n  const checkPermissions = async () => {\n    try {\n      const result = await navigator.permissions.query({ name: 'microphone' });\n      setPermissionStatus(result.state);\n      \n      result.addEventListener('change', () => {\n        setPermissionStatus(result.state);\n        if (result.state === 'denied' && isRecording) {\n          stopRecording();\n        }\n      });\n    } catch (err) {\n      console.warn('Permission API not supported, fallback to getUserMedia');\n    }\n  };\n\n  // Cleanup function to properly stop all recording activities\n  const cleanup = useCallback(() => {\n    // Stop timer\n    if (timerRef.current) {\n      clearInterval(timerRef.current);\n      timerRef.current = null;\n    }\n    \n    // Stop animation\n    if (animationRef.current) {\n      cancelAnimationFrame(animationRef.current);\n      animationRef.current = null;\n    }\n    \n    // Close audio context\n    if (audioContextRef.current && audioContextRef.current.state !== 'closed') {\n      audioContextRef.current.close();\n      audioContextRef.current = null;\n    }\n    \n    // Stop media recorder\n    if (mediaRecorderRef.current && mediaRecorderRef.current.state !== 'inactive') {\n      try {\n        mediaRecorderRef.current.stop();\n      } catch (e) {\n        console.warn('MediaRecorder was already stopped');\n      }\n      mediaRecorderRef.current = null;\n    }\n    \n    // Stop audio stream\n    if (audioStream) {\n      audioStream.getTracks().forEach(track => {\n        track.stop();\n      });\n      setAudioStream(null);\n    }\n    \n    // Reset states\n    setIsRecording(false);\n    setRecordingTime(0);\n    setError(null);\n  }, [audioStream]);\n\n  // Main cleanup useEffect\n  useEffect(() => {\n    return cleanup;\n  }, [cleanup]);\n\n  // Timer effect\n  useEffect(() => {\n    if (isRecording) {\n      timerRef.current = setInterval(() => {\n        setRecordingTime((prev) => prev + 1);\n      }, 1000);\n    } else {\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n        timerRef.current = null;\n      }\n      setRecordingTime(0);\n    }\n    \n    return () => {\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n      }\n    };\n  }, [isRecording]);\n\n  const drawWaveform = useCallback(() => {\n    if (!canvasRef.current || !analyserRef.current) return;\n    \n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n    const analyser = analyserRef.current;\n    const dataArray = dataArrayRef.current;\n\n    const draw = () => {\n      if (!isRecording) return; // Stop drawing if not recording\n      \n      animationRef.current = requestAnimationFrame(draw);\n      analyser.getByteTimeDomainData(dataArray);\n\n      ctx.fillStyle = \"#fff\";\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n      ctx.lineWidth = 2;\n      ctx.strokeStyle = \"#25D366\";\n      ctx.beginPath();\n\n      const sliceWidth = (canvas.width * 1.0) / dataArray.length;\n      let x = 0;\n\n      for (let i = 0; i < dataArray.length; i++) {\n        const v = dataArray[i] / 128.0;\n        const y = (v * canvas.height) / 2;\n\n        if (i === 0) {\n          ctx.moveTo(x, y);\n        } else {\n          ctx.lineTo(x, y);\n        }\n\n        x += sliceWidth;\n      }\n      ctx.lineTo(canvas.width, canvas.height / 2);\n      ctx.stroke();\n    };\n    \n    draw();\n  }, [isRecording]);\n\n  const startRecording = async () => {\n    try {\n      setError(null);\n      \n      // First, clean up any existing recording\n      cleanup();\n      \n      // Check permissions first\n      await checkPermissions();\n      if (permissionStatus === 'denied') {\n        setError('Microphone access denied. Please enable microphone permissions.');\n        return;\n      }\n\n      // Get new stream\n      const stream = await navigator.mediaDevices.getUserMedia({ \n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          sampleRate: 44100\n        } \n      });\n      \n      setAudioStream(stream);\n\n      // Set up audio context for visualization\n      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n      const source = audioCtx.createMediaStreamSource(stream);\n      const analyser = audioCtx.createAnalyser();\n      source.connect(analyser);\n      analyser.fftSize = 2048;\n      const bufferLength = analyser.frequencyBinCount;\n      const dataArray = new Uint8Array(bufferLength);\n\n      audioContextRef.current = audioCtx;\n      analyserRef.current = analyser;\n      dataArrayRef.current = dataArray;\n\n      // Set up media recorder\n      const mediaRecorder = new MediaRecorder(stream, {\n        mimeType: MediaRecorder.isTypeSupported(\"audio/webm\") ? \"audio/webm\" : \"audio/ogg\",\n        audioBitsPerSecond: 128000,\n      });\n\n      mediaRecorderRef.current = mediaRecorder;\n      audioChunksRef.current = [];\n\n      mediaRecorder.ondataavailable = (event) => {\n        if (event.data.size > 0) {\n          audioChunksRef.current.push(event.data);\n        }\n      };\n\n      mediaRecorder.onstop = () => {\n        const mimeType = mediaRecorder.mimeType || 'audio/webm';\n        const blob = new Blob(audioChunksRef.current, { type: mimeType });\n        const url = URL.createObjectURL(blob);\n        \n        setRecordings((prev) => [...prev, { \n          url, \n          blob, \n          duration: recordingTime,\n          timestamp: new Date().toLocaleTimeString()\n        }]);\n\n        audioChunksRef.current = [];\n      };\n\n      mediaRecorder.onerror = (event) => {\n        console.error('MediaRecorder error:', event);\n        setError('Recording failed: ' + event.error);\n        cleanup();\n      };\n\n      // Start recording\n      mediaRecorder.start(100); // Collect data every 100ms\n      setIsRecording(true);\n      \n      // Start waveform drawing\n      drawWaveform();\n\n    } catch (err) {\n      console.error(\"Recording error:\", err);\n      setError(`Recording failed: ${err.message}`);\n      cleanup();\n    }\n  };\n\n  const stopRecording = () => {\n    if (mediaRecorderRef.current && mediaRecorderRef.current.state === 'recording') {\n      mediaRecorderRef.current.stop();\n    }\n    cleanup();\n  };\n\n  const copyToClipboard = async (blob) => {\n    try {\n      if (!navigator.clipboard.write) {\n        throw new Error('Clipboard API not supported');\n      }\n      \n      const file = new File([blob], \"voice.webm\", { type: blob.type });\n      const item = new ClipboardItem({ [file.type]: file });\n      await navigator.clipboard.write([item]);\n      alert(\"Audio copied to clipboard!\");\n    } catch (err) {\n      console.error(\"Clipboard write failed:\", err);\n      alert(\"Copy failed: \" + err.message);\n    }\n  };\n\n  const saveRecording = (blob) => {\n    const a = document.createElement(\"a\");\n    a.href = URL.createObjectURL(blob);\n    a.download = `recording_${Date.now()}.webm`;\n    document.body.appendChild(a);\n    a.click();\n    document.body.removeChild(a);\n    URL.revokeObjectURL(a.href);\n  };\n\n  const removeRecording = (index) => {\n    setRecordings((prev) => {\n      const newRecordings = prev.filter((_, i) => i !== index);\n      // Clean up object URL to prevent memory leaks\n      URL.revokeObjectURL(prev[index].url);\n      return newRecordings;\n    });\n  };\n\n  return (\n    <div className=\"bg-[#ece5dd] min-h-screen p-4 space-y-4\">\n      {/* Permission Status */}\n      <div className=\"text-sm text-gray-600 mb-2\">\n        Microphone: {permissionStatus === 'granted' ? '✅ Granted' : \n                     permissionStatus === 'denied' ? '❌ Denied' : '⏳ Pending'}\n      </div>\n\n      {/* Error Display */}\n      {error && (\n        <div className=\"bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded mb-4\">\n          {error}\n          <button \n            onClick={() => setError(null)}\n            className=\"float-right text-red-500 hover:text-red-700\"\n          >\n            ×\n          </button>\n        </div>\n      )}\n\n      {/* Recording Controls */}\n      <div className=\"flex items-center space-x-2\">\n        {!isRecording ? (\n          <button\n            onClick={startRecording}\n            disabled={permissionStatus === 'denied'}\n            className={`px-4 py-2 rounded-full shadow-md transition-colors ${\n              permissionStatus === 'denied' \n                ? 'bg-gray-300 text-gray-500 cursor-not-allowed' \n                : 'bg-white border border-gray-300 hover:bg-gray-100 text-black'\n            }`}\n            title={permissionStatus === 'denied' ? 'Microphone access denied' : 'Start recording'}\n          >\n            🎙️ Start Recording\n          </button>\n        ) : (\n          <button\n            onClick={stopRecording}\n            className=\"bg-red-500 hover:bg-red-600 text-white px-4 py-2 rounded-full shadow-md relative transition-colors\"\n            title=\"Stop recording\"\n          >\n            ⏹️ Stop ({recordingTime}s)\n            <span className=\"absolute -top-1 -right-1 w-3 h-3 bg-red-400 rounded-full animate-ping\" />\n          </button>\n        )}\n      </div>\n\n      {/* Waveform Visualization */}\n      {isRecording && (\n        <div className=\"bg-white p-3 rounded-lg shadow\">\n          <canvas\n            ref={canvasRef}\n            width={400}\n            height={80}\n            className=\"w-full border rounded\"\n          />\n          <div className=\"text-center text-sm text-gray-500 mt-2\">\n            Recording... {recordingTime}s\n          </div>\n        </div>\n      )}\n\n      {/* Recordings List */}\n      <div className=\"space-y-3\">\n        {recordings.length === 0 ? (\n          <div className=\"text-center text-gray-500 py-8\">\n            No recordings yet. Click \"Start Recording\" to begin.\n          </div>\n        ) : (\n          recordings.map((rec, index) => (\n            <div\n              key={index}\n              className=\"flex items-center space-x-3 bg-[#dcf8c6] p-3 rounded-xl shadow-md w-fit max-w-full\"\n            >\n              <img\n                src=\"https://www.gravatar.com/avatar?d=mp\"\n                alt=\"Avatar\"\n                className=\"w-10 h-10 rounded-full flex-shrink-0\"\n              />\n              <div className=\"flex flex-col min-w-0 flex-1\">\n                <audio controls src={rec.url} className=\"w-60 min-w-0\" />\n                <div className=\"text-xs text-gray-500 flex justify-between\">\n                  <span>{rec.duration}s</span>\n                  <span>{rec.timestamp}</span>\n                </div>\n              </div>\n              <div className=\"flex space-x-1 flex-shrink-0\">\n                <button\n                  onClick={() => copyToClipboard(rec.blob)}\n                  className=\"text-green-700 hover:text-green-900 p-1 rounded transition-colors\"\n                  title=\"Copy to clipboard\"\n                >\n                  📋\n                </button>\n                <button\n                  onClick={() => saveRecording(rec.blob)}\n                  className=\"text-blue-700 hover:text-blue-900 p-1 rounded transition-colors\"\n                  title=\"Download recording\"\n                >\n                  💾\n                </button>\n                <button\n                  onClick={() => removeRecording(index)}\n                  className=\"text-red-700 hover:text-red-900 p-1 rounded transition-colors\"\n                  title=\"Delete recording\"\n                >\n                  🗑️\n                </button>\n              </div>\n            </div>\n          ))\n        )}\n      </div>\n\n      {/* Debug Info */}\n      {process.env.NODE_ENV === 'development' && (\n        <div className=\"mt-8 p-4 bg-gray-100 rounded text-xs\">\n          <h4 className=\"font-bold mb-2\">Debug Info:</h4>\n          <div>Recording: {isRecording ? 'Yes' : 'No'}</div>\n          <div>Stream: {audioStream ? 'Active' : 'None'}</div>\n          <div>MediaRecorder: {mediaRecorderRef.current?.state || 'None'}</div>\n          <div>Permission: {permissionStatus}</div>\n        </div>\n      )}\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}