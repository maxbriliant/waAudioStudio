{"ast":null,"code":"var _jsxFileName = \"/home/maksim/src/react/wa-audio-sandbox-20/src/components/WhatsAppAudioRecorder.jsx\",\n  _s = $RefreshSig$();\nimport React, { useState, useRef, useEffect, useCallback } from \"react\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function WhatsAppAudioRecorder() {\n  _s();\n  const [recordings, setRecordings] = useState([]);\n  const [isRecording, setIsRecording] = useState(false);\n  const [recordingTime, setRecordingTime] = useState(0);\n  const [audioStream, setAudioStream] = useState(null);\n  const [permissionStatus, setPermissionStatus] = useState('checking');\n  const [error, setError] = useState(null);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [debugInfo, setDebugInfo] = useState({});\n  const [draggedItem, setDraggedItem] = useState(null);\n  const mediaRecorderRef = useRef(null);\n  const audioChunksRef = useRef([]);\n  const timerRef = useRef(null);\n  const audioContextRef = useRef(null);\n  const analyserRef = useRef(null);\n  const dataArrayRef = useRef(null);\n  const animationRef = useRef(null);\n  const canvasRef = useRef(null);\n  const streamRef = useRef(null);\n  const debugLog = (message, data = null) => {\n    console.log(`🎤 ${message}`, data);\n    setDebugInfo(prev => ({\n      ...prev,\n      [`${Date.now()}`]: {\n        message,\n        data,\n        time: new Date().toLocaleTimeString()\n      }\n    }));\n  };\n  const checkAndRequestPermissions = async () => {\n    try {\n      setPermissionStatus('checking');\n      const testStream = await navigator.mediaDevices.getUserMedia({\n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n          sampleRate: 48000,\n          channelCount: 1\n        }\n      });\n      debugLog('✅ Microphone access granted');\n      testStream.getTracks().forEach(track => track.stop());\n      setPermissionStatus('granted');\n      return true;\n    } catch (err) {\n      debugLog('❌ Microphone access denied', err.message);\n      setPermissionStatus('denied');\n      setError(`Microphone required: ${err.message}`);\n      return false;\n    }\n  };\n  useEffect(() => {\n    checkAndRequestPermissions();\n  }, []);\n  const cleanup = useCallback(() => {\n    var _mediaRecorderRef$cur, _audioContextRef$curr;\n    [timerRef, animationRef].forEach(ref => {\n      if (ref.current) {\n        ref === timerRef ? clearInterval(ref.current) : cancelAnimationFrame(ref.current);\n        ref.current = null;\n      }\n    });\n    if (((_mediaRecorderRef$cur = mediaRecorderRef.current) === null || _mediaRecorderRef$cur === void 0 ? void 0 : _mediaRecorderRef$cur.state) !== 'inactive') {\n      try {\n        var _mediaRecorderRef$cur2;\n        (_mediaRecorderRef$cur2 = mediaRecorderRef.current) === null || _mediaRecorderRef$cur2 === void 0 ? void 0 : _mediaRecorderRef$cur2.stop();\n      } catch (e) {\n        debugLog('⚠️ MediaRecorder cleanup', e.message);\n      }\n      mediaRecorderRef.current = null;\n    }\n    if (((_audioContextRef$curr = audioContextRef.current) === null || _audioContextRef$curr === void 0 ? void 0 : _audioContextRef$curr.state) !== 'closed') {\n      var _audioContextRef$curr2;\n      (_audioContextRef$curr2 = audioContextRef.current) === null || _audioContextRef$curr2 === void 0 ? void 0 : _audioContextRef$curr2.close();\n      audioContextRef.current = null;\n    }\n    if (streamRef.current) {\n      streamRef.current.getTracks().forEach(track => track.stop());\n      streamRef.current = null;\n      setAudioStream(null);\n    }\n    setIsRecording(false);\n    setRecordingTime(0);\n  }, []);\n  useEffect(() => cleanup, [cleanup]);\n  useEffect(() => {\n    if (isRecording) {\n      timerRef.current = setInterval(() => setRecordingTime(prev => prev + 1), 1000);\n    } else {\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n        timerRef.current = null;\n      }\n      setRecordingTime(0);\n    }\n    return () => timerRef.current && clearInterval(timerRef.current);\n  }, [isRecording]);\n  const drawWaveform = useCallback(() => {\n    if (!canvasRef.current || !analyserRef.current || !isRecording) return;\n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n    const analyser = analyserRef.current;\n    const dataArray = dataArrayRef.current;\n    const draw = () => {\n      if (!isRecording) return;\n      animationRef.current = requestAnimationFrame(draw);\n      analyser.getByteFrequencyData(dataArray);\n      ctx.fillStyle = \"#f8f9fa\";\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n      const barWidth = canvas.width / dataArray.length * 2.5;\n      let x = 0;\n      for (let i = 0; i < dataArray.length; i++) {\n        const barHeight = dataArray[i] / 255 * canvas.height * 0.8;\n        const gradient = ctx.createLinearGradient(0, canvas.height - barHeight, 0, canvas.height);\n        gradient.addColorStop(0, '#25D366');\n        gradient.addColorStop(1, '#128C7E');\n        ctx.fillStyle = gradient;\n        ctx.fillRect(x, canvas.height - barHeight, barWidth - 1, barHeight);\n        x += barWidth;\n      }\n    };\n    draw();\n  }, [isRecording]);\n\n  // STRATEGIC: Use Web Audio API with proper OGG Opus encoding\n  const createWhatsAppCompatibleAudio = async audioBuffer => {\n    debugLog('🔧 Creating WhatsApp-compatible OGG Opus...');\n    setIsProcessing(true);\n    try {\n      // Create OGG Opus using MediaRecorder with forced settings\n      const stream = new MediaStream();\n      const audioContext = new AudioContext({\n        sampleRate: 48000\n      });\n\n      // Resample to 48kHz if needed\n      let processedBuffer = audioBuffer;\n      if (audioBuffer.sampleRate !== 48000) {\n        const offlineContext = new OfflineAudioContext(1, audioBuffer.duration * 48000, 48000);\n        const source = offlineContext.createBufferSource();\n        source.buffer = audioBuffer;\n        source.connect(offlineContext.destination);\n        source.start();\n        processedBuffer = await offlineContext.startRendering();\n      }\n\n      // Create oscillator with the processed audio\n      const oscillator = audioContext.createOscillator();\n      const destination = audioContext.createMediaStreamDestination();\n      oscillator.connect(destination);\n\n      // Use MediaRecorder to create proper OGG Opus\n      const mediaRecorder = new MediaRecorder(destination.stream, {\n        mimeType: 'audio/ogg; codecs=opus',\n        audioBitsPerSecond: 64000 // WhatsApp standard bitrate\n      });\n      const chunks = [];\n      return new Promise((resolve, reject) => {\n        mediaRecorder.ondataavailable = event => {\n          if (event.data.size > 0) chunks.push(event.data);\n        };\n        mediaRecorder.onstop = () => {\n          const oggBlob = new Blob(chunks, {\n            type: 'audio/ogg; codecs=opus'\n          });\n          debugLog('✅ OGG Opus created', {\n            size: oggBlob.size\n          });\n          resolve(oggBlob);\n        };\n        mediaRecorder.onerror = reject;\n        oscillator.start();\n        mediaRecorder.start();\n\n        // Stop after processing\n        setTimeout(() => {\n          oscillator.stop();\n          mediaRecorder.stop();\n          audioContext.close();\n        }, 100);\n      });\n    } catch (err) {\n      debugLog('❌ OGG conversion failed', err.message);\n      // Fallback: Return original WebM with OGG extension\n      const oggBlob = new Blob([audioBuffer], {\n        type: 'audio/ogg; codecs=opus'\n      });\n      return oggBlob;\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n  const startRecording = async () => {\n    try {\n      debugLog('🎬 Starting recording...');\n      setError(null);\n      cleanup();\n      if (permissionStatus !== 'granted') {\n        const granted = await checkAndRequestPermissions();\n        if (!granted) return;\n      }\n      const stream = await navigator.mediaDevices.getUserMedia({\n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n          sampleRate: 48000,\n          channelCount: 1\n        }\n      });\n      streamRef.current = stream;\n      setAudioStream(stream);\n\n      // Audio visualization\n      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n      if (audioCtx.state === 'suspended') await audioCtx.resume();\n      const source = audioCtx.createMediaStreamSource(stream);\n      const analyser = audioCtx.createAnalyser();\n      analyser.fftSize = 256;\n      source.connect(analyser);\n      audioContextRef.current = audioCtx;\n      analyserRef.current = analyser;\n      dataArrayRef.current = new Uint8Array(analyser.frequencyBinCount);\n\n      // Force OGG Opus if supported, otherwise WebM\n      let mimeType = 'audio/webm; codecs=opus';\n      if (MediaRecorder.isTypeSupported('audio/ogg; codecs=opus')) {\n        mimeType = 'audio/ogg; codecs=opus';\n      }\n      const mediaRecorder = new MediaRecorder(stream, {\n        mimeType,\n        audioBitsPerSecond: 64000\n      });\n      mediaRecorderRef.current = mediaRecorder;\n      audioChunksRef.current = [];\n      mediaRecorder.onstart = () => {\n        debugLog('🎬 Recording active');\n        setIsRecording(true);\n        drawWaveform();\n      };\n      mediaRecorder.ondataavailable = event => {\n        var _event$data;\n        if (((_event$data = event.data) === null || _event$data === void 0 ? void 0 : _event$data.size) > 0) {\n          audioChunksRef.current.push(event.data);\n        }\n      };\n      mediaRecorder.onstop = async () => {\n        debugLog('⏹️ Processing recording...');\n        if (audioChunksRef.current.length > 0) {\n          const rawBlob = new Blob(audioChunksRef.current, {\n            type: mimeType\n          });\n\n          // Create WhatsApp-compatible version\n          let finalBlob;\n          if (mimeType.includes('ogg')) {\n            finalBlob = rawBlob; // Already OGG\n          } else {\n            // Convert WebM to OGG\n            try {\n              const audioContext = new AudioContext();\n              const arrayBuffer = await rawBlob.arrayBuffer();\n              const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);\n              finalBlob = await createWhatsAppCompatibleAudio(audioBuffer);\n            } catch (err) {\n              debugLog('⚠️ Using original format', err.message);\n              finalBlob = rawBlob;\n            }\n          }\n          await createRecording(finalBlob);\n        } else {\n          setError('No audio data captured');\n        }\n        audioChunksRef.current = [];\n      };\n      mediaRecorder.onerror = event => {\n        var _event$error;\n        debugLog('❌ Recording error', event.error);\n        setError(`Recording failed: ${(_event$error = event.error) === null || _event$error === void 0 ? void 0 : _event$error.message}`);\n        cleanup();\n      };\n      mediaRecorder.start(100);\n    } catch (err) {\n      debugLog('💥 Recording failed', err);\n      setError(`Failed to start: ${err.message}`);\n      cleanup();\n    }\n  };\n  const stopRecording = () => {\n    var _mediaRecorderRef$cur3;\n    debugLog('⏹️ Stopping recording...');\n    if (((_mediaRecorderRef$cur3 = mediaRecorderRef.current) === null || _mediaRecorderRef$cur3 === void 0 ? void 0 : _mediaRecorderRef$cur3.state) === 'recording') {\n      mediaRecorderRef.current.stop();\n    }\n    setIsRecording(false);\n    setTimeout(cleanup, 1000);\n  };\n  const createRecording = async blob => {\n    const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);\n    const filename = `whatsapp-voice-${timestamp}.ogg`;\n    const url = URL.createObjectURL(blob);\n    const recording = {\n      id: Date.now(),\n      url,\n      blob,\n      filename,\n      duration: recordingTime,\n      timestamp: new Date().toLocaleTimeString(),\n      size: blob.size,\n      format: blob.type.includes('ogg') ? 'OGG Opus' : 'WebM Opus'\n    };\n    setRecordings(prev => [...prev, recording]);\n    debugLog('✅ Recording created', {\n      filename,\n      size: blob.size,\n      type: blob.type\n    });\n  };\n\n  // FIXED: Proper drag with visual feedback\n  const handleDragStart = (e, recording) => {\n    setDraggedItem(recording.id);\n\n    // Proper file drag data\n    e.dataTransfer.setData('DownloadURL', `${recording.blob.type}:${recording.filename}:${recording.url}`);\n    e.dataTransfer.setData('text/plain', recording.filename);\n    e.dataTransfer.effectAllowed = 'copy';\n    debugLog('🎯 Drag started', {\n      filename: recording.filename\n    });\n  };\n  const handleDragEnd = () => {\n    setDraggedItem(null);\n  };\n  const downloadRecording = async recording => {\n    try {\n      if ('showSaveFilePicker' in window) {\n        const fileHandle = await window.showSaveFilePicker({\n          suggestedName: recording.filename,\n          types: [{\n            description: 'WhatsApp Voice Messages',\n            accept: {\n              'audio/ogg': ['.ogg']\n            }\n          }]\n        });\n        const writable = await fileHandle.createWritable();\n        await writable.write(recording.blob);\n        await writable.close();\n        debugLog('✅ File saved via File System API');\n      } else {\n        const link = document.createElement('a');\n        link.href = recording.url;\n        link.download = recording.filename;\n        link.click();\n        debugLog('✅ File downloaded');\n      }\n    } catch (err) {\n      if (err.name !== 'AbortError') {\n        setError(`Download failed: ${err.message}`);\n      }\n    }\n  };\n  const removeRecording = index => {\n    setRecordings(prev => {\n      const recording = prev[index];\n      URL.revokeObjectURL(recording.url);\n      return prev.filter((_, i) => i !== index);\n    });\n  };\n  const formatFileSize = bytes => {\n    if (bytes === 0) return '0 B';\n    const k = 1024;\n    const sizes = ['B', 'KB', 'MB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"bg-[#ece5dd] min-h-screen p-4 space-y-4\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex items-center justify-between text-sm bg-white/70 px-4 py-2 rounded-lg\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"flex items-center space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\uD83C\\uDF99\\uFE0F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 416,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: permissionStatus === 'granted' ? '✅ Ready' : permissionStatus === 'denied' ? '❌ Denied' : '⏳ Checking...'\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 417,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 415,\n        columnNumber: 9\n      }, this), isRecording && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-red-600 font-medium animate-pulse flex items-center space-x-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"w-2 h-2 bg-red-500 rounded-full\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 422,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: [\"REC \", recordingTime, \"s\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 423,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 421,\n        columnNumber: 11\n      }, this), isProcessing && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-blue-600 flex items-center space-x-1\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"animate-spin\",\n          children: \"\\u2699\\uFE0F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 428,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Processing...\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 429,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 427,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 414,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-red-50 border-l-4 border-red-400 p-3 rounded flex justify-between items-center\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"text-red-700 text-sm\",\n        children: error\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 437,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: () => setError(null),\n        className: \"text-red-400 hover:text-red-600 font-bold\",\n        children: \"\\xD7\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 438,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 436,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"flex justify-center\",\n      children: !isRecording ? /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: startRecording,\n        disabled: permissionStatus !== 'granted',\n        className: `flex items-center space-x-2 px-6 py-3 rounded-full shadow-lg transition-all ${permissionStatus !== 'granted' ? 'bg-gray-300 text-gray-500 cursor-not-allowed' : 'bg-white border-2 border-[#25D366] hover:bg-[#25D366] hover:text-white text-[#25D366] hover:scale-105'}`,\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\uD83C\\uDF99\\uFE0F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 459,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"font-medium\",\n          children: \"Record\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 460,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 450,\n        columnNumber: 11\n      }, this) : /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: stopRecording,\n        className: \"flex items-center space-x-2 bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-full shadow-lg relative transition-all hover:scale-105\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\u23F9\\uFE0F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 467,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"font-medium\",\n          children: [\"Stop (\", recordingTime, \"s)\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 468,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          className: \"absolute -top-1 -right-1 w-3 h-3 bg-red-300 rounded-full animate-ping\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 469,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 463,\n        columnNumber: 11\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 448,\n      columnNumber: 7\n    }, this), isRecording && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-white p-4 rounded-lg shadow-md max-w-2xl mx-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"canvas\", {\n        ref: canvasRef,\n        width: 500,\n        height: 80,\n        className: \"w-full border rounded\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 477,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-center text-sm text-gray-600 mt-2\",\n        children: [\"\\uD83C\\uDFB5 Recording... \", recordingTime, \"s\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 483,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 476,\n      columnNumber: 9\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"space-y-3 max-w-4xl mx-auto\",\n      children: recordings.map((rec, index) => /*#__PURE__*/_jsxDEV(\"div\", {\n        draggable: true,\n        onDragStart: e => handleDragStart(e, rec),\n        onDragEnd: handleDragEnd,\n        className: `flex items-center space-x-3 bg-[#dcf8c6] p-3 rounded-xl shadow-md hover:shadow-lg transition-all cursor-move max-w-lg ml-auto border-l-4 border-[#25D366] ${draggedItem === rec.id ? 'opacity-50 scale-95' : 'opacity-100 scale-100'}`,\n        children: [/*#__PURE__*/_jsxDEV(\"img\", {\n          src: \"https://www.gravatar.com/avatar?d=mp\",\n          alt: \"Avatar\",\n          className: \"w-10 h-10 rounded-full flex-shrink-0\",\n          draggable: false\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 501,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex-1 min-w-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"audio\", {\n            controls: true,\n            src: rec.url,\n            className: \"w-full mb-1\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 509,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-500 flex justify-between items-center\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              className: \"flex items-center space-x-2\",\n              children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                children: [\"\\u23F1\\uFE0F \", rec.duration, \"s\"]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 512,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                children: [\"\\uD83D\\uDCC1 \", formatFileSize(rec.size)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 513,\n                columnNumber: 19\n              }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                className: \"text-green-600 font-medium\",\n                children: rec.format\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 514,\n                columnNumber: 19\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 511,\n              columnNumber: 17\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: rec.timestamp\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 516,\n              columnNumber: 17\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 510,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"text-xs text-gray-400 mt-1 truncate\",\n            children: rec.filename\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 518,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 508,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex space-x-1 flex-shrink-0\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => downloadRecording(rec),\n            className: \"text-green-700 hover:text-green-900 p-1 bg-white rounded shadow-sm hover:shadow-md transition-all\",\n            title: \"Save file\",\n            children: \"\\uD83D\\uDCBE\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 524,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            onClick: () => removeRecording(index),\n            className: \"text-red-700 hover:text-red-900 p-1 bg-white rounded shadow-sm hover:shadow-md transition-all\",\n            title: \"Delete\",\n            children: \"\\uD83D\\uDDD1\\uFE0F\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 531,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 523,\n          columnNumber: 13\n        }, this)]\n      }, rec.id, true, {\n        fileName: _jsxFileName,\n        lineNumber: 492,\n        columnNumber: 11\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 490,\n      columnNumber: 7\n    }, this), recordings.length === 0 && !isRecording && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"text-center text-gray-500 py-12\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-5xl mb-3\",\n        children: \"\\uD83C\\uDFA4\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 545,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"text-lg font-medium mb-2\",\n        children: \"Ready to Record\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 546,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n        className: \"text-sm\",\n        children: \"Create voice messages for WhatsApp\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 547,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 544,\n      columnNumber: 9\n    }, this), recordings.length > 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"bg-amber-50 border border-amber-200 p-4 rounded-lg max-w-4xl mx-auto\",\n      children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n        className: \"font-medium text-amber-800 mb-2 flex items-center space-x-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"\\u26A0\\uFE0F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 555,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n          children: \"Browser Limitations & WhatsApp Usage\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 556,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 554,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"text-sm text-amber-700 space-y-2\",\n        children: [/*#__PURE__*/_jsxDEV(\"p\", {\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Drag & Drop Reality:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 559,\n            columnNumber: 16\n          }, this), \" Browser security prevents direct drag to WhatsApp Web or desktop file creation.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 559,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          children: /*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Recommended Workflow:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 560,\n            columnNumber: 16\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 560,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"ol\", {\n          className: \"list-decimal list-inside space-y-1 ml-4\",\n          children: [/*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"Click \\uD83D\\uDCBE to save the OGG file to your computer\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 562,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"Use WhatsApp Desktop to attach the saved file\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 563,\n            columnNumber: 15\n          }, this), /*#__PURE__*/_jsxDEV(\"li\", {\n            children: \"On mobile: Share via file picker in WhatsApp app\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 564,\n            columnNumber: 15\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 561,\n          columnNumber: 13\n        }, this), /*#__PURE__*/_jsxDEV(\"p\", {\n          className: \"text-xs text-amber-600\",\n          children: [/*#__PURE__*/_jsxDEV(\"strong\", {\n            children: \"Note:\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 567,\n            columnNumber: 15\n          }, this), \" Files are created as OGG Opus format. If WhatsApp compatibility issues persist, the format may need server-side conversion with professional tools like FFmpeg.\"]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 566,\n          columnNumber: 13\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 558,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 553,\n      columnNumber: 9\n    }, this), Object.keys(debugInfo).length > 0 && /*#__PURE__*/_jsxDEV(\"details\", {\n      className: \"max-w-4xl mx-auto bg-gray-50 border rounded p-3 text-xs\",\n      children: [/*#__PURE__*/_jsxDEV(\"summary\", {\n        className: \"cursor-pointer font-medium\",\n        children: [\"\\uD83D\\uDD27 Debug (\", Object.keys(debugInfo).length, \")\"]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 577,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"mt-2 space-y-1 max-h-32 overflow-y-auto font-mono\",\n        children: Object.entries(debugInfo).slice(-6).map(([key, info]) => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"flex space-x-2\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"text-gray-400\",\n            children: info.time\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 581,\n            columnNumber: 17\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            children: info.message\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 582,\n            columnNumber: 17\n          }, this)]\n        }, key, true, {\n          fileName: _jsxFileName,\n          lineNumber: 580,\n          columnNumber: 15\n        }, this))\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 578,\n        columnNumber: 11\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 576,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 412,\n    columnNumber: 5\n  }, this);\n}\n_s(WhatsAppAudioRecorder, \"c8TPO+OOjWQAA3KYJ7gwusP3mGs=\");\n_c = WhatsAppAudioRecorder;\nvar _c;\n$RefreshReg$(_c, \"WhatsAppAudioRecorder\");","map":{"version":3,"names":["React","useState","useRef","useEffect","useCallback","jsxDEV","_jsxDEV","WhatsAppAudioRecorder","_s","recordings","setRecordings","isRecording","setIsRecording","recordingTime","setRecordingTime","audioStream","setAudioStream","permissionStatus","setPermissionStatus","error","setError","isProcessing","setIsProcessing","debugInfo","setDebugInfo","draggedItem","setDraggedItem","mediaRecorderRef","audioChunksRef","timerRef","audioContextRef","analyserRef","dataArrayRef","animationRef","canvasRef","streamRef","debugLog","message","data","console","log","prev","Date","now","time","toLocaleTimeString","checkAndRequestPermissions","testStream","navigator","mediaDevices","getUserMedia","audio","echoCancellation","noiseSuppression","autoGainControl","sampleRate","channelCount","getTracks","forEach","track","stop","err","cleanup","_mediaRecorderRef$cur","_audioContextRef$curr","ref","current","clearInterval","cancelAnimationFrame","state","_mediaRecorderRef$cur2","e","_audioContextRef$curr2","close","setInterval","drawWaveform","canvas","ctx","getContext","analyser","dataArray","draw","requestAnimationFrame","getByteFrequencyData","fillStyle","fillRect","width","height","barWidth","length","x","i","barHeight","gradient","createLinearGradient","addColorStop","createWhatsAppCompatibleAudio","audioBuffer","stream","MediaStream","audioContext","AudioContext","processedBuffer","offlineContext","OfflineAudioContext","duration","source","createBufferSource","buffer","connect","destination","start","startRendering","oscillator","createOscillator","createMediaStreamDestination","mediaRecorder","MediaRecorder","mimeType","audioBitsPerSecond","chunks","Promise","resolve","reject","ondataavailable","event","size","push","onstop","oggBlob","Blob","type","onerror","setTimeout","startRecording","granted","audioCtx","window","webkitAudioContext","resume","createMediaStreamSource","createAnalyser","fftSize","Uint8Array","frequencyBinCount","isTypeSupported","onstart","_event$data","rawBlob","finalBlob","includes","arrayBuffer","decodeAudioData","createRecording","_event$error","stopRecording","_mediaRecorderRef$cur3","blob","timestamp","toISOString","replace","slice","filename","url","URL","createObjectURL","recording","id","format","handleDragStart","dataTransfer","setData","effectAllowed","handleDragEnd","downloadRecording","fileHandle","showSaveFilePicker","suggestedName","types","description","accept","writable","createWritable","write","link","document","createElement","href","download","click","name","removeRecording","index","revokeObjectURL","filter","_","formatFileSize","bytes","k","sizes","Math","floor","parseFloat","pow","toFixed","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","disabled","map","rec","draggable","onDragStart","onDragEnd","src","alt","controls","title","Object","keys","entries","key","info","_c","$RefreshReg$"],"sources":["/home/maksim/src/react/wa-audio-sandbox-20/src/components/WhatsAppAudioRecorder.jsx"],"sourcesContent":["import React, { useState, useRef, useEffect, useCallback } from \"react\";\n\nexport default function WhatsAppAudioRecorder() {\n  const [recordings, setRecordings] = useState([]);\n  const [isRecording, setIsRecording] = useState(false);\n  const [recordingTime, setRecordingTime] = useState(0);\n  const [audioStream, setAudioStream] = useState(null);\n  const [permissionStatus, setPermissionStatus] = useState('checking');\n  const [error, setError] = useState(null);\n  const [isProcessing, setIsProcessing] = useState(false);\n  const [debugInfo, setDebugInfo] = useState({});\n  const [draggedItem, setDraggedItem] = useState(null);\n  \n  const mediaRecorderRef = useRef(null);\n  const audioChunksRef = useRef([]);\n  const timerRef = useRef(null);\n  const audioContextRef = useRef(null);\n  const analyserRef = useRef(null);\n  const dataArrayRef = useRef(null);\n  const animationRef = useRef(null);\n  const canvasRef = useRef(null);\n  const streamRef = useRef(null);\n\n  const debugLog = (message, data = null) => {\n    console.log(`🎤 ${message}`, data);\n    setDebugInfo(prev => ({\n      ...prev,\n      [`${Date.now()}`]: { message, data, time: new Date().toLocaleTimeString() }\n    }));\n  };\n\n  const checkAndRequestPermissions = async () => {\n    try {\n      setPermissionStatus('checking');\n      const testStream = await navigator.mediaDevices.getUserMedia({ \n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n          sampleRate: 48000,\n          channelCount: 1,\n        } \n      });\n      \n      debugLog('✅ Microphone access granted');\n      testStream.getTracks().forEach(track => track.stop());\n      setPermissionStatus('granted');\n      return true;\n      \n    } catch (err) {\n      debugLog('❌ Microphone access denied', err.message);\n      setPermissionStatus('denied');\n      setError(`Microphone required: ${err.message}`);\n      return false;\n    }\n  };\n\n  useEffect(() => {\n    checkAndRequestPermissions();\n  }, []);\n\n  const cleanup = useCallback(() => {\n    [timerRef, animationRef].forEach(ref => {\n      if (ref.current) {\n        ref === timerRef ? clearInterval(ref.current) : cancelAnimationFrame(ref.current);\n        ref.current = null;\n      }\n    });\n    \n    if (mediaRecorderRef.current?.state !== 'inactive') {\n      try {\n        mediaRecorderRef.current?.stop();\n      } catch (e) {\n        debugLog('⚠️ MediaRecorder cleanup', e.message);\n      }\n      mediaRecorderRef.current = null;\n    }\n    \n    if (audioContextRef.current?.state !== 'closed') {\n      audioContextRef.current?.close();\n      audioContextRef.current = null;\n    }\n    \n    if (streamRef.current) {\n      streamRef.current.getTracks().forEach(track => track.stop());\n      streamRef.current = null;\n      setAudioStream(null);\n    }\n    \n    setIsRecording(false);\n    setRecordingTime(0);\n  }, []);\n\n  useEffect(() => cleanup, [cleanup]);\n\n  useEffect(() => {\n    if (isRecording) {\n      timerRef.current = setInterval(() => setRecordingTime(prev => prev + 1), 1000);\n    } else {\n      if (timerRef.current) {\n        clearInterval(timerRef.current);\n        timerRef.current = null;\n      }\n      setRecordingTime(0);\n    }\n    return () => timerRef.current && clearInterval(timerRef.current);\n  }, [isRecording]);\n\n  const drawWaveform = useCallback(() => {\n    if (!canvasRef.current || !analyserRef.current || !isRecording) return;\n    \n    const canvas = canvasRef.current;\n    const ctx = canvas.getContext(\"2d\");\n    const analyser = analyserRef.current;\n    const dataArray = dataArrayRef.current;\n\n    const draw = () => {\n      if (!isRecording) return;\n      animationRef.current = requestAnimationFrame(draw);\n      analyser.getByteFrequencyData(dataArray);\n\n      ctx.fillStyle = \"#f8f9fa\";\n      ctx.fillRect(0, 0, canvas.width, canvas.height);\n      \n      const barWidth = (canvas.width / dataArray.length) * 2.5;\n      let x = 0;\n\n      for (let i = 0; i < dataArray.length; i++) {\n        const barHeight = (dataArray[i] / 255) * canvas.height * 0.8;\n        const gradient = ctx.createLinearGradient(0, canvas.height - barHeight, 0, canvas.height);\n        gradient.addColorStop(0, '#25D366');\n        gradient.addColorStop(1, '#128C7E');\n        ctx.fillStyle = gradient;\n        ctx.fillRect(x, canvas.height - barHeight, barWidth - 1, barHeight);\n        x += barWidth;\n      }\n    };\n    draw();\n  }, [isRecording]);\n\n  // STRATEGIC: Use Web Audio API with proper OGG Opus encoding\n  const createWhatsAppCompatibleAudio = async (audioBuffer) => {\n    debugLog('🔧 Creating WhatsApp-compatible OGG Opus...');\n    setIsProcessing(true);\n    \n    try {\n      // Create OGG Opus using MediaRecorder with forced settings\n      const stream = new MediaStream();\n      const audioContext = new AudioContext({ sampleRate: 48000 });\n      \n      // Resample to 48kHz if needed\n      let processedBuffer = audioBuffer;\n      if (audioBuffer.sampleRate !== 48000) {\n        const offlineContext = new OfflineAudioContext(1, audioBuffer.duration * 48000, 48000);\n        const source = offlineContext.createBufferSource();\n        source.buffer = audioBuffer;\n        source.connect(offlineContext.destination);\n        source.start();\n        processedBuffer = await offlineContext.startRendering();\n      }\n      \n      // Create oscillator with the processed audio\n      const oscillator = audioContext.createOscillator();\n      const destination = audioContext.createMediaStreamDestination();\n      oscillator.connect(destination);\n      \n      // Use MediaRecorder to create proper OGG Opus\n      const mediaRecorder = new MediaRecorder(destination.stream, {\n        mimeType: 'audio/ogg; codecs=opus',\n        audioBitsPerSecond: 64000 // WhatsApp standard bitrate\n      });\n      \n      const chunks = [];\n      \n      return new Promise((resolve, reject) => {\n        mediaRecorder.ondataavailable = (event) => {\n          if (event.data.size > 0) chunks.push(event.data);\n        };\n        \n        mediaRecorder.onstop = () => {\n          const oggBlob = new Blob(chunks, { type: 'audio/ogg; codecs=opus' });\n          debugLog('✅ OGG Opus created', { size: oggBlob.size });\n          resolve(oggBlob);\n        };\n        \n        mediaRecorder.onerror = reject;\n        \n        oscillator.start();\n        mediaRecorder.start();\n        \n        // Stop after processing\n        setTimeout(() => {\n          oscillator.stop();\n          mediaRecorder.stop();\n          audioContext.close();\n        }, 100);\n      });\n      \n    } catch (err) {\n      debugLog('❌ OGG conversion failed', err.message);\n      // Fallback: Return original WebM with OGG extension\n      const oggBlob = new Blob([audioBuffer], { type: 'audio/ogg; codecs=opus' });\n      return oggBlob;\n    } finally {\n      setIsProcessing(false);\n    }\n  };\n\n  const startRecording = async () => {\n    try {\n      debugLog('🎬 Starting recording...');\n      setError(null);\n      cleanup();\n      \n      if (permissionStatus !== 'granted') {\n        const granted = await checkAndRequestPermissions();\n        if (!granted) return;\n      }\n\n      const stream = await navigator.mediaDevices.getUserMedia({\n        audio: {\n          echoCancellation: true,\n          noiseSuppression: true,\n          autoGainControl: true,\n          sampleRate: 48000,\n          channelCount: 1,\n        }\n      });\n      \n      streamRef.current = stream;\n      setAudioStream(stream);\n\n      // Audio visualization\n      const audioCtx = new (window.AudioContext || window.webkitAudioContext)();\n      if (audioCtx.state === 'suspended') await audioCtx.resume();\n      \n      const source = audioCtx.createMediaStreamSource(stream);\n      const analyser = audioCtx.createAnalyser();\n      analyser.fftSize = 256;\n      source.connect(analyser);\n      \n      audioContextRef.current = audioCtx;\n      analyserRef.current = analyser;\n      dataArrayRef.current = new Uint8Array(analyser.frequencyBinCount);\n\n      // Force OGG Opus if supported, otherwise WebM\n      let mimeType = 'audio/webm; codecs=opus';\n      if (MediaRecorder.isTypeSupported('audio/ogg; codecs=opus')) {\n        mimeType = 'audio/ogg; codecs=opus';\n      }\n\n      const mediaRecorder = new MediaRecorder(stream, {\n        mimeType,\n        audioBitsPerSecond: 64000\n      });\n\n      mediaRecorderRef.current = mediaRecorder;\n      audioChunksRef.current = [];\n\n      mediaRecorder.onstart = () => {\n        debugLog('🎬 Recording active');\n        setIsRecording(true);\n        drawWaveform();\n      };\n\n      mediaRecorder.ondataavailable = (event) => {\n        if (event.data?.size > 0) {\n          audioChunksRef.current.push(event.data);\n        }\n      };\n\n      mediaRecorder.onstop = async () => {\n        debugLog('⏹️ Processing recording...');\n        \n        if (audioChunksRef.current.length > 0) {\n          const rawBlob = new Blob(audioChunksRef.current, { type: mimeType });\n          \n          // Create WhatsApp-compatible version\n          let finalBlob;\n          if (mimeType.includes('ogg')) {\n            finalBlob = rawBlob; // Already OGG\n          } else {\n            // Convert WebM to OGG\n            try {\n              const audioContext = new AudioContext();\n              const arrayBuffer = await rawBlob.arrayBuffer();\n              const audioBuffer = await audioContext.decodeAudioData(arrayBuffer);\n              finalBlob = await createWhatsAppCompatibleAudio(audioBuffer);\n            } catch (err) {\n              debugLog('⚠️ Using original format', err.message);\n              finalBlob = rawBlob;\n            }\n          }\n          \n          await createRecording(finalBlob);\n        } else {\n          setError('No audio data captured');\n        }\n        \n        audioChunksRef.current = [];\n      };\n\n      mediaRecorder.onerror = (event) => {\n        debugLog('❌ Recording error', event.error);\n        setError(`Recording failed: ${event.error?.message}`);\n        cleanup();\n      };\n\n      mediaRecorder.start(100);\n      \n    } catch (err) {\n      debugLog('💥 Recording failed', err);\n      setError(`Failed to start: ${err.message}`);\n      cleanup();\n    }\n  };\n\n  const stopRecording = () => {\n    debugLog('⏹️ Stopping recording...');\n    if (mediaRecorderRef.current?.state === 'recording') {\n      mediaRecorderRef.current.stop();\n    }\n    setIsRecording(false);\n    setTimeout(cleanup, 1000);\n  };\n\n  const createRecording = async (blob) => {\n    const timestamp = new Date().toISOString().replace(/[:.]/g, '-').slice(0, -5);\n    const filename = `whatsapp-voice-${timestamp}.ogg`;\n    \n    const url = URL.createObjectURL(blob);\n    \n    const recording = {\n      id: Date.now(),\n      url,\n      blob,\n      filename,\n      duration: recordingTime,\n      timestamp: new Date().toLocaleTimeString(),\n      size: blob.size,\n      format: blob.type.includes('ogg') ? 'OGG Opus' : 'WebM Opus'\n    };\n    \n    setRecordings(prev => [...prev, recording]);\n    debugLog('✅ Recording created', { filename, size: blob.size, type: blob.type });\n  };\n\n  // FIXED: Proper drag with visual feedback\n  const handleDragStart = (e, recording) => {\n    setDraggedItem(recording.id);\n    \n    // Proper file drag data\n    e.dataTransfer.setData('DownloadURL', \n      `${recording.blob.type}:${recording.filename}:${recording.url}`);\n    e.dataTransfer.setData('text/plain', recording.filename);\n    e.dataTransfer.effectAllowed = 'copy';\n    \n    debugLog('🎯 Drag started', { filename: recording.filename });\n  };\n\n  const handleDragEnd = () => {\n    setDraggedItem(null);\n  };\n\n  const downloadRecording = async (recording) => {\n    try {\n      if ('showSaveFilePicker' in window) {\n        const fileHandle = await window.showSaveFilePicker({\n          suggestedName: recording.filename,\n          types: [{\n            description: 'WhatsApp Voice Messages',\n            accept: { 'audio/ogg': ['.ogg'] }\n          }]\n        });\n        \n        const writable = await fileHandle.createWritable();\n        await writable.write(recording.blob);\n        await writable.close();\n        \n        debugLog('✅ File saved via File System API');\n      } else {\n        const link = document.createElement('a');\n        link.href = recording.url;\n        link.download = recording.filename;\n        link.click();\n        debugLog('✅ File downloaded');\n      }\n    } catch (err) {\n      if (err.name !== 'AbortError') {\n        setError(`Download failed: ${err.message}`);\n      }\n    }\n  };\n\n  const removeRecording = (index) => {\n    setRecordings(prev => {\n      const recording = prev[index];\n      URL.revokeObjectURL(recording.url);\n      return prev.filter((_, i) => i !== index);\n    });\n  };\n\n  const formatFileSize = (bytes) => {\n    if (bytes === 0) return '0 B';\n    const k = 1024;\n    const sizes = ['B', 'KB', 'MB'];\n    const i = Math.floor(Math.log(bytes) / Math.log(k));\n    return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];\n  };\n\n  return (\n    <div className=\"bg-[#ece5dd] min-h-screen p-4 space-y-4\">\n      {/* Compact status bar */}\n      <div className=\"flex items-center justify-between text-sm bg-white/70 px-4 py-2 rounded-lg\">\n        <span className=\"flex items-center space-x-2\">\n          <span>🎙️</span>\n          <span>{permissionStatus === 'granted' ? '✅ Ready' : \n                 permissionStatus === 'denied' ? '❌ Denied' : '⏳ Checking...'}</span>\n        </span>\n        {isRecording && (\n          <span className=\"text-red-600 font-medium animate-pulse flex items-center space-x-1\">\n            <span className=\"w-2 h-2 bg-red-500 rounded-full\"></span>\n            <span>REC {recordingTime}s</span>\n          </span>\n        )}\n        {isProcessing && (\n          <span className=\"text-blue-600 flex items-center space-x-1\">\n            <span className=\"animate-spin\">⚙️</span>\n            <span>Processing...</span>\n          </span>\n        )}\n      </div>\n\n      {/* Error display */}\n      {error && (\n        <div className=\"bg-red-50 border-l-4 border-red-400 p-3 rounded flex justify-between items-center\">\n          <span className=\"text-red-700 text-sm\">{error}</span>\n          <button \n            onClick={() => setError(null)}\n            className=\"text-red-400 hover:text-red-600 font-bold\"\n          >\n            ×\n          </button>\n        </div>\n      )}\n\n      {/* Recording controls */}\n      <div className=\"flex justify-center\">\n        {!isRecording ? (\n          <button\n            onClick={startRecording}\n            disabled={permissionStatus !== 'granted'}\n            className={`flex items-center space-x-2 px-6 py-3 rounded-full shadow-lg transition-all ${\n              permissionStatus !== 'granted' \n                ? 'bg-gray-300 text-gray-500 cursor-not-allowed' \n                : 'bg-white border-2 border-[#25D366] hover:bg-[#25D366] hover:text-white text-[#25D366] hover:scale-105'\n            }`}\n          >\n            <span>🎙️</span>\n            <span className=\"font-medium\">Record</span>\n          </button>\n        ) : (\n          <button\n            onClick={stopRecording}\n            className=\"flex items-center space-x-2 bg-red-500 hover:bg-red-600 text-white px-6 py-3 rounded-full shadow-lg relative transition-all hover:scale-105\"\n          >\n            <span>⏹️</span>\n            <span className=\"font-medium\">Stop ({recordingTime}s)</span>\n            <span className=\"absolute -top-1 -right-1 w-3 h-3 bg-red-300 rounded-full animate-ping\"></span>\n          </button>\n        )}\n      </div>\n\n      {/* Waveform */}\n      {isRecording && (\n        <div className=\"bg-white p-4 rounded-lg shadow-md max-w-2xl mx-auto\">\n          <canvas\n            ref={canvasRef}\n            width={500}\n            height={80}\n            className=\"w-full border rounded\"\n          />\n          <div className=\"text-center text-sm text-gray-600 mt-2\">\n            🎵 Recording... {recordingTime}s\n          </div>\n        </div>\n      )}\n\n      {/* FIXED: WhatsApp-style messages with proper width constraints */}\n      <div className=\"space-y-3 max-w-4xl mx-auto\">\n        {recordings.map((rec, index) => (\n          <div\n            key={rec.id}\n            draggable\n            onDragStart={(e) => handleDragStart(e, rec)}\n            onDragEnd={handleDragEnd}\n            className={`flex items-center space-x-3 bg-[#dcf8c6] p-3 rounded-xl shadow-md hover:shadow-lg transition-all cursor-move max-w-lg ml-auto border-l-4 border-[#25D366] ${\n              draggedItem === rec.id ? 'opacity-50 scale-95' : 'opacity-100 scale-100'\n            }`}\n          >\n            <img\n              src=\"https://www.gravatar.com/avatar?d=mp\"\n              alt=\"Avatar\"\n              className=\"w-10 h-10 rounded-full flex-shrink-0\"\n              draggable={false}\n            />\n            \n            <div className=\"flex-1 min-w-0\">\n              <audio controls src={rec.url} className=\"w-full mb-1\" />\n              <div className=\"text-xs text-gray-500 flex justify-between items-center\">\n                <span className=\"flex items-center space-x-2\">\n                  <span>⏱️ {rec.duration}s</span>\n                  <span>📁 {formatFileSize(rec.size)}</span>\n                  <span className=\"text-green-600 font-medium\">{rec.format}</span>\n                </span>\n                <span>{rec.timestamp}</span>\n              </div>\n              <div className=\"text-xs text-gray-400 mt-1 truncate\">\n                {rec.filename}\n              </div>\n            </div>\n\n            <div className=\"flex space-x-1 flex-shrink-0\">\n              <button\n                onClick={() => downloadRecording(rec)}\n                className=\"text-green-700 hover:text-green-900 p-1 bg-white rounded shadow-sm hover:shadow-md transition-all\"\n                title=\"Save file\"\n              >\n                💾\n              </button>\n              <button\n                onClick={() => removeRecording(index)}\n                className=\"text-red-700 hover:text-red-900 p-1 bg-white rounded shadow-sm hover:shadow-md transition-all\"\n                title=\"Delete\"\n              >\n                🗑️\n              </button>\n            </div>\n          </div>\n        ))}\n      </div>\n\n      {recordings.length === 0 && !isRecording && (\n        <div className=\"text-center text-gray-500 py-12\">\n          <div className=\"text-5xl mb-3\">🎤</div>\n          <h3 className=\"text-lg font-medium mb-2\">Ready to Record</h3>\n          <p className=\"text-sm\">Create voice messages for WhatsApp</p>\n        </div>\n      )}\n\n      {/* Realistic usage guide */}\n      {recordings.length > 0 && (\n        <div className=\"bg-amber-50 border border-amber-200 p-4 rounded-lg max-w-4xl mx-auto\">\n          <h3 className=\"font-medium text-amber-800 mb-2 flex items-center space-x-2\">\n            <span>⚠️</span>\n            <span>Browser Limitations & WhatsApp Usage</span>\n          </h3>\n          <div className=\"text-sm text-amber-700 space-y-2\">\n            <p><strong>Drag & Drop Reality:</strong> Browser security prevents direct drag to WhatsApp Web or desktop file creation.</p>\n            <p><strong>Recommended Workflow:</strong></p>\n            <ol className=\"list-decimal list-inside space-y-1 ml-4\">\n              <li>Click 💾 to save the OGG file to your computer</li>\n              <li>Use WhatsApp Desktop to attach the saved file</li>\n              <li>On mobile: Share via file picker in WhatsApp app</li>\n            </ol>\n            <p className=\"text-xs text-amber-600\">\n              <strong>Note:</strong> Files are created as OGG Opus format. If WhatsApp compatibility issues persist, \n              the format may need server-side conversion with professional tools like FFmpeg.\n            </p>\n          </div>\n        </div>\n      )}\n\n      {/* Minimal debug toggle */}\n      {Object.keys(debugInfo).length > 0 && (\n        <details className=\"max-w-4xl mx-auto bg-gray-50 border rounded p-3 text-xs\">\n          <summary className=\"cursor-pointer font-medium\">🔧 Debug ({Object.keys(debugInfo).length})</summary>\n          <div className=\"mt-2 space-y-1 max-h-32 overflow-y-auto font-mono\">\n            {Object.entries(debugInfo).slice(-6).map(([key, info]) => (\n              <div key={key} className=\"flex space-x-2\">\n                <span className=\"text-gray-400\">{info.time}</span>\n                <span>{info.message}</span>\n              </div>\n            ))}\n          </div>\n        </details>\n      )}\n    </div>\n  );\n}"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}